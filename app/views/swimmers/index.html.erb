<% provide(:title, 'CHECK IN') %>

<div ng-controller='SwimmersCtrl'>
  <h1>Check In</h1>

  <div class='u-pull-left'>
    <input class='u-input-width'
           type='text'
           ng-model='search.last_name'
           placeholder='Search Last Name'
           autocorrect='off'/>
  </div>

  <table class='u-full-width'>
    <thead ng-show='filterSwimmers.length'>
      <tr>
        <th></th>
        <th class='visible-xs'></th>
        <th class='hidden-xs medium-grey-text'>Name</th>
        <th class='hidden-xs medium-grey-text'>USMS#</th>
        <th class='hidden-xs medium-grey-text'>LMSC</th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="swimmer in filterSwimmers = (swimmers
                    | orderBy:['last_name','first_name']
                    | filter:search.last_name
                    | limitTo:totalDisplayed)">
        <td>
          <button ng-if='!swimmer.phone_number'
                  ng-click="open(swimmer)"
                  class='button button-primary button-width-default'>
            Add Phone
          </button>
          <button ng-if='swimmer.phone_number'
                  ng-click="checkIn(swimmer)"
                  ng-class="!swimmer.swimmer_checked_in && swimmer.phone_number ? 'button-success' : 'button-danger button-disabled'"
                  class='button button-width-default'>
            {{!swimmer.swimmer_checked_in && swimmer.phone_number ? 'Check In' : 'Checked In'}}
          </button>
        </td>
        <td>
          <a ng-href='/swimmers/{{swimmer.id}}'>{{swimmer.last_name}}, {{swimmer.first_name}} {{swimmer.mi}}</a>
        </td>
        <td class='hidden-xs medium-grey-text'>{{swimmer.usms_number}}</td>
        <th class='hidden-xs medium-grey-text'>{{swimmer.lmsc}}</td>
      </tr>
    </tbody>
  </table>

  <center>
    <div ng-show='!filterSwimmers.length'>
      <p>No results found <a href='#' ng-click="search.last_name=''"> new search?</a></p>
      <%= link_to 'Search Out of State', out_of_state_path, class: 'button button-info button-info-solid' %>
    </div>
    <div ng-show='filterSwimmers.length'>
      <btn class='button button-info button-width-extended button-info-solid' ng-click='loadMore()'>Load More</btn>
    </div>
  </center>
</div>
